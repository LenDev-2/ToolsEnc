<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serious Encryptor</title>

<style>
:root{
  --bg:#020617;
  --card:rgba(15,23,42,.8);
  --border:rgba(148,163,184,.25);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --blue:#2563eb;
  --green:#14b8a6;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#020b2a,#020617 65%);
  font-family:monospace;
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
}

.card{
  width:100%;
  max-width:560px;
  background:var(--card);
  backdrop-filter:blur(12px);
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px;
  animation:fade .4s ease;
}

@keyframes fade{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

h2{
  margin:0 0 16px;
  text-align:center;
  color:#c7d2fe;
}

label{
  font-size:12px;
  color:var(--muted);
  display:block;
  margin-top:12px;
}

textarea,
input{
  width:100%;
  margin-top:6px;
  padding:12px;
  background:#020617;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:10px;
  font-family:monospace;
  font-size:14px;
}

textarea{min-height:120px;resize:vertical}

.password-wrap{
  position:relative;
}

.password-wrap span{
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  cursor:pointer;
  color:#64748b;
  font-size:13px;
}

.actions{
  display:flex;
  gap:10px;
  margin-top:16px;
}

button{
  flex:1;
  padding:12px;
  border:none;
  border-radius:10px;
  font-family:monospace;
  font-weight:bold;
  cursor:pointer;
  transition:.15s;
}

.encrypt{background:linear-gradient(135deg,#1e40af,#2563eb);color:white}
.decrypt{background:linear-gradient(135deg,#0f766e,#14b8a6);color:#022c22}

button:active{transform:scale(.96)}

.copy{
  margin-top:10px;
  background:#020617;
  border:1px dashed var(--border);
  color:#94a3b8;
}

.footer{
  text-align:center;
  margin-top:14px;
  font-size:11px;
  color:#64748b;
}

@media(max-width:480px){
  textarea,input,button{font-size:13px}
}
</style>
</head>

<body>

<div class="card">
  <h2>AES-256-GCM Encryptor</h2>

  <label>TEXT / CIPHER</label>
  <textarea id="text" placeholder="Masukin teks atau hasil encrypt"></textarea>

  <label>PASSWORD</label>
  <div class="password-wrap">
    <input id="password" type="password" placeholder="Pakai yang kuat">
    <span onclick="togglePass()">üëÅ</span>
  </div>

  <div class="actions">
    <button class="encrypt" onclick="encrypt()">ENCRYPT</button>
    <button class="decrypt" onclick="decrypt()">DECRYPT</button>
  </div>

  <label>RESULT</label>
  <textarea id="result" placeholder="Hasil muncul di sini"></textarea>
  <button class="copy" onclick="copyResult()">COPY RESULT</button>

  <div class="footer">Client-side only ¬∑ AES-256-GCM</div>
</div>

<script>
const enc = new TextEncoder();
const dec = new TextDecoder();

function bufToBase64(buf){
  return btoa(String.fromCharCode(...new Uint8Array(buf)));
}
function base64ToBuf(b64){
  return Uint8Array.from(atob(b64), c => c.charCodeAt(0));
}

function togglePass(){
  const p = document.getElementById("password");
  p.type = p.type === "password" ? "text" : "password";
}

function copyResult(){
  const r = document.getElementById("result");
  if(!r.value) return;
  navigator.clipboard.writeText(r.value);
}

async function deriveKey(password, salt){
  const keyMaterial = await crypto.subtle.importKey(
    "raw", enc.encode(password), "PBKDF2", false, ["deriveKey"]
  );
  return crypto.subtle.deriveKey(
    {name:"PBKDF2",salt,iterations:100000,hash:"SHA-256"},
    keyMaterial,
    {name:"AES-GCM",length:256},
    false,
    ["encrypt","decrypt"]
  );
}

async function encrypt(){
  const text = document.getElementById("text").value;
  const pass = document.getElementById("password").value;
  if(!pass) return alert("Password kosong");

  const salt = crypto.getRandomValues(new Uint8Array(16));
  const iv   = crypto.getRandomValues(new Uint8Array(12));
  const key  = await deriveKey(pass, salt);

  const encrypted = await crypto.subtle.encrypt(
    {name:"AES-GCM",iv},
    key,
    enc.encode(text)
  );

  document.getElementById("result").value =
    btoa(JSON.stringify({
      s:bufToBase64(salt),
      i:bufToBase64(iv),
      d:bufToBase64(encrypted)
    }));
}

async function decrypt(){
  const input = document.getElementById("text").value;
  const pass  = document.getElementById("password").value;
  if(!pass) return alert("Password kosong");

  try{
    const data = JSON.parse(atob(input));
    const key = await deriveKey(pass, base64ToBuf(data.s));
    const decd = await crypto.subtle.decrypt(
      {name:"AES-GCM",iv:base64ToBuf(data.i)},
      key,
      base64ToBuf(data.d)
    );
    document.getElementById("result").value = dec.decode(decd);
  }catch{
    alert("Password salah atau data rusak");
  }
}
</script>

</body>
</html>
